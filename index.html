<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indigenous SAP CoPilot - Root Cause Analysis Assistant</title>
    <script src="https://cdn.jsdelivr.net/npm/marked@4.0.0/marked.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f4f4f4;
        }
        .header {
            text-align: center;
            background-color: #007bff;
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        .panel {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        textarea, input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
            margin-bottom: 10px;
        }
        button {
            background-color: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
        }
        button:hover {
            background-color: #0056b3;
        }
        #analysisResult, #promptResult, #emailDraft {
            margin-top: 10px;
            padding: 10px;
            background-color: #e9ecef;
            border-radius: 4px;
            white-space: pre-wrap;
            min-height: 100px;
        }
        .full-width {
            grid-column: span 2;
        }
        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
            }
            .full-width {
                grid-column: span 1;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Indigenous SAP CoPilot</h1>
        <p>AI-Powered Root Cause Analysis for SAP Dumps, Code Interaction, and Functional Reporting</p>
    </div>

    <div class="container">
        <div class="panel">
            <h2>SAP Dump Input</h2>
            <textarea id="dumpInput" rows="10" placeholder="Paste your SAP ABAP dump here (e.g., from ST22 transaction). Include error description, runtime error, source code extract, etc."></textarea>
            <button onclick="analyzeDump()">Analyze Root Cause</button>
            <div id="analysisResult">Analysis will appear here...</div>
        </div>

        <div class="panel">
            <h2>Code Details Prompt</h2>
            <input type="text" id="codeQuery" placeholder="e.g., Explain this ABAP function module logic">
            <textarea id="codeContext" rows="5" placeholder="Paste relevant ABAP code snippet here"></textarea>
            <button onclick="generateDevPrompt()">Generate Prompt for Developer</button>
            <div id="promptResult">Generated prompt will appear here...</div>
        </div>

        <div class="panel full-width">
            <h2>Email Draft to Functional Team</h2>
            <textarea id="emailInput" rows="5" placeholder="Summarize key findings from analysis (optional)"></textarea>
            <button onclick="draftEmail()">Draft Email</button>
            <div id="emailDraft">Email draft will appear here...</div>
        </div>
    </div>

    <script>
        // Simulated AI responses using prompt engineering principles
        // In a real implementation, integrate with Grok API or similar LLM via fetch()

        async function simulateLLM(prompt) {
            // Placeholder for API call; for demo, use a simple delay and mock response
            return new Promise((resolve) => {
                setTimeout(() => {
                    // Mock responses based on input; in production, send to LLM
                    if (prompt.includes('dump')) {
                        resolve(`### Root Cause Analysis\n\n**Error Summary:** Based on the provided dump, the runtime error is likely a ${prompt.includes('DIVIDE') ? 'DIVISION_BY_ZERO' : 'MEMORY_DUMP'} at line ${Math.floor(Math.random() * 100) + 100}.\n\n**Root Causes:**\n- Primary: Invalid data division (e.g., divide by zero in ABAP code).\n- Secondary: Memory overflow due to large dataset processing.\n- Recommendations: Add exception handling (TRY-CATCH), validate inputs before operations.\n\n**Next Steps:** Review code at specified line; test with sample data.<grok-card data-id="e9d08c" data-type="citation_card"></grok-card>`);
                    } else if (prompt.includes('code')) {
                        resolve(`**Generated Prompt for Developer:**\n\nYou are an expert ABAP developer. Analyze the following code snippet:\n\n\`\`\`abap\n${document.getElementById('codeContext').value}\n\`\`\`\n\nQuestion: ${document.getElementById('codeQuery').value}\n\nProvide: 1) Step-by-step logic explanation. 2) Potential issues (e.g., performance, errors). 3) Suggested improvements using best practices like modularization and error handling. Use few-shot examples if needed for clarity.<grok-card data-id="d7250c" data-type="citation_card"></grok-card>`);
                    } else {
                        resolve(`**Email Draft:**\n\nSubject: Root Cause Analysis for Recent SAP Dump - Action Required\n\nDear Functional Team,\n\nWe encountered a dump in [Module/Transaction] on [Date]. Analysis shows root cause as [e.g., data validation failure leading to divide by zero].\n\n**Details:**\n- Error: ${document.getElementById('emailInput').value || 'See attached dump'}\n- Impact: [e.g., Batch job failure affecting 500 records]\n- Recommended Fix: Update business logic to handle null values.\n\nPlease review and provide business confirmation on workaround. Let me know if you need the full dump.\n\nBest regards,\nSAP Technical Team`);
                    }
                }, 1000);
            });
        }

        async function analyzeDump() {
            const dump = document.getElementById('dumpInput').value;
            if (!dump) {
                alert('Please paste the SAP dump first.');
                return;
            }
            const resultDiv = document.getElementById('analysisResult');
            resultDiv.innerHTML = 'Analyzing...';
            const prompt = `Analyze this SAP ABAP dump for root cause: ${dump}. Focus on error type, line of code, possible causes (e.g., data issues, code bugs), and fixes. Structure as: Summary, Causes, Recommendations.`;
            const response = await simulateLLM(prompt);
            resultDiv.innerHTML = marked.parse(response);
        }

        async function generateDevPrompt() {
            const query = document.getElementById('codeQuery').value;
            const context = document.getElementById('codeContext').value;
            if (!query || !context) {
                alert('Please enter query and code context.');
                return;
            }
            const resultDiv = document.getElementById('promptResult');
            resultDiv.innerHTML = 'Generating...';
            const prompt = `Create a detailed prompt for an ABAP developer to analyze: Query: ${query}, Code: ${context}. Use prompt engineering: role-playing, step-by-step instructions, few-shot examples.`;
            const response = await simulateLLM(prompt);
            resultDiv.innerHTML = marked.parse(response);
        }

        async function draftEmail() {
            const summary = document.getElementById('emailInput').value;
            const resultDiv = document.getElementById('emailDraft');
            resultDiv.innerHTML = 'Drafting...';
            const prompt = `Draft a professional email to SAP functional team based on root cause analysis summary: ${summary || 'Default analysis'}. Include subject, greeting, details, impact, recommendations, closing. Keep concise and actionable.`;
            const response = await simulateLLM(prompt);
            resultDiv.innerHTML = marked.parse(response);
        }
    </script>
</body>
</html>